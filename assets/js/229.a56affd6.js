(window.webpackJsonp=window.webpackJsonp||[]).push([[229],{469:function(s,t,a){"use strict";a.r(t);var n=a(12),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("blockquote",[a("p",[s._v("è¿™æ˜¯é˜…è¯»ã€ŠMongoDB å®æˆ˜ã€‹æ‰€åšçš„ï¼Œå…³äºåŸºç¡€ã€ç¼–ç å’Œä¼˜åŒ–æ–¹é¢çš„è¯»ä¹¦ç¬”è®°ã€‚")])]),s._v(" "),a("h2",{attrs:{id:"mongodb-ç‰¹æ€§å’Œä»‹ç»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-ç‰¹æ€§å’Œä»‹ç»"}},[s._v("#")]),s._v(" MongoDB ç‰¹æ€§å’Œä»‹ç»")]),s._v(" "),a("h3",{attrs:{id:"_1-ç®€ä»‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-ç®€ä»‹"}},[s._v("#")]),s._v(" 1. ç®€ä»‹")]),s._v(" "),a("p",[s._v("MongoDB çš„ç‰¹ç‚¹ï¼šæ‰©å±•ç­–ç•¥ã€ç›´è§‚çš„æ•°æ®æ¨¡å‹ã€‚åœ¨ mongodb ä¸­ï¼Œç¼–ç¨‹è¯­è¨€å®šä¹‰çš„å¯¹è±¡èƒ½è¢«â€œåŸå°ä¸å˜â€åœ°æŒä¹…åŒ–ï¼Œæ¶ˆé™¤å¯¹è±¡ç»“æ„å’Œç¨‹åºæ˜ å°„çš„å¤æ‚æ€§ã€‚")]),s._v(" "),a("h3",{attrs:{id:"_2-ä¸»è¦ç‰¹æ€§"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-ä¸»è¦ç‰¹æ€§"}},[s._v("#")]),s._v(" 2. ä¸»è¦ç‰¹æ€§")]),s._v(" "),a("h4",{attrs:{id:"æ•°æ®æ¨¡å‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ•°æ®æ¨¡å‹"}},[s._v("#")]),s._v(" æ•°æ®æ¨¡å‹")]),s._v(" "),a("p",[s._v("å…³ç³»å‹ä¸æ­£è§„åŒ–ï¼šå¯¹äºå…³ç³»å‹æ•°æ®åº“ï¼Œæ•°æ®è¡¨æœ¬è´¨ä¸Šæ˜¯"),a("strong",[s._v("æ‰å¹³çš„")]),s._v("ï¼Œå› æ­¤è¡¨ç¤ºå¤šä¸ªä¸€å¯¹å¤šå…³ç³»å°±éœ€è¦å¤šå¼ è¡¨ã€‚ç»å¸¸ç”¨åˆ°çš„æŠ€æœ¯æ˜¯"),a("strong",[s._v("æ‹†è¡¨")]),s._v("ï¼Œè¿™ç§æŠ€æœ¯æ˜¯"),a("strong",[s._v("æ­£è§„åŒ–")]),s._v("ã€‚")]),s._v(" "),a("p",[s._v("ä½†å¯¹äº Mongo æ¥è¯´ï¼Œæ–‡æ¡£æ”¯æŒåµŒå¥—ç­‰å¤šç§æ ¼å¼ï¼Œæ— éœ€äº‹å…ˆå®šä¹‰"),a("strong",[s._v("Schema")]),s._v("ã€‚")]),s._v(" "),a("h4",{attrs:{id:"å³æ—¶æŸ¥è¯¢"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å³æ—¶æŸ¥è¯¢"}},[s._v("#")]),s._v(" å³æ—¶æŸ¥è¯¢")]),s._v(" "),a("p",[s._v("mysql å’Œ mongodb éƒ½æ”¯æŒ"),a("strong",[s._v("å³æ—¶æŸ¥è¯¢")]),s._v("ï¼Œä¸åŒçš„æ˜¯ï¼šå‰è€…ä¾èµ–æ­£åˆ™åŒ–çš„æ¨¡å‹ï¼›åè€…å‡å®šæŸ¥è¯¢å­—æ®µæ˜¯å­˜å‚¨ä¸æ–‡æ¡£ä¸­çš„ã€‚")]),s._v(" "),a("h4",{attrs:{id:"äºŒçº§ç´¢å¼•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#äºŒçº§ç´¢å¼•"}},[s._v("#")]),s._v(" äºŒçº§ç´¢å¼•")]),s._v(" "),a("p",[s._v("mongodb æ”¯æŒäºŒçº§ç´¢å¼•ï¼Œæ˜¯é€šè¿‡ b-tree å®ç°çš„ã€‚")]),s._v(" "),a("h4",{attrs:{id:"å¤åˆ¶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¤åˆ¶"}},[s._v("#")]),s._v(" å¤åˆ¶")]),s._v(" "),a("p",[s._v("é€šè¿‡"),a("strong",[s._v("å‰¯æœ¬é›†")]),s._v("çš„æ‹“æ‰‘ç»“æ„æ¥æä¾›å¤åˆ¶åŠŸèƒ½ï¼Œå…¶ç›®çš„æ˜¯ï¼š"),a("strong",[s._v("æä¾›æ•°æ®çš„å†—ä½™")]),s._v("ã€‚")]),s._v(" "),a("p",[s._v("å‰¯æœ¬é›†çš„ä¸»èŠ‚ç‚¹èƒ½æ¥å—è¯»å†™æ“ä½œï¼Œä½†ä»èŠ‚ç‚¹æ˜¯åªè¯»çš„ã€‚ä¸»èŠ‚ç‚¹å‡ºé—®é¢˜ï¼Œä¼šè‡ªåŠ¨æ•…éšœè½¬ç§»ï¼Œé€‰å–ä¸€ä¸ªä»èŠ‚ç‚¹å‡çº§ä¸ºä¸»èŠ‚ç‚¹ã€‚")]),s._v(" "),a("h4",{attrs:{id:"å†™é€Ÿåº¦å’ŒæŒä¹…æ€§"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å†™é€Ÿåº¦å’ŒæŒä¹…æ€§"}},[s._v("#")]),s._v(" å†™é€Ÿåº¦å’ŒæŒä¹…æ€§")]),s._v(" "),a("p",[s._v("å†™é€Ÿåº¦ï¼šç»™å®šæ—¶é—´å†…ï¼Œæ•°æ®åº“å¯ä»¥å¤„ç†çš„æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤æ“ä½œçš„æ•°é‡ã€‚")]),s._v(" "),a("p",[s._v("æŒä¹…æ€§ï¼šæ•°æ®åº“ä¿æŒä¸Šè¿°å†™æ“ä½œçš„ç»“æœä¸æ”¹å˜çš„ï¼Œæ‰€ç”¨çš„æ—¶é—´é•¿çŸ­ã€‚")]),s._v(" "),a("p",[s._v("DB é¢†åŸŸï¼Œ"),a("strong",[s._v("å†™é€Ÿåº¦å’ŒæŒä¹…æ€§å­˜åœ¨ä¸€ç§ç›¸åå…³ç³»")]),s._v("ã€‚å¾ˆå¥½ç†è§£ï¼Œä¾‹å¦‚ memcachedï¼Œç›´æ¥å†™å…¥å†…å­˜ï¼Œå†™é€Ÿåº¦éå¸¸å¿«ï¼Œä½†åŒæ—¶æ•°æ®å®Œå…¨æ˜“å¤±ã€‚")]),s._v(" "),a("p",[s._v("mongodb çš„å†™æ“ä½œï¼Œé»˜è®¤æ˜¯"),a("strong",[s._v("fire-and-forget")]),s._v("ï¼šé€šè¿‡ TCP å‘é€å†™æ“ä½œï¼Œä¸è¦æ±‚æ•°æ®åº“åº”ç­”ã€‚ç”¨æˆ·å¯ä»¥å¼€å¯"),a("strong",[s._v("å®‰å…¨æ¨¡å¼")]),s._v("ï¼Œä¿è¯å†™æ“ä½œæ­£ç¡®æ— è¯¯å†™å…¥ dbã€‚å¹¶ä¸”å®‰å…¨æ¨¡å¼å¯ä»¥é…ç½®ï¼Œç”¨äº"),a("strong",[s._v("é˜»å¡æ“ä½œ")]),s._v("ã€‚")]),s._v(" "),a("p",[s._v("å¯¹äºé«˜å®¹é‡ã€ä½ä»·å€¼æ•°æ®ï¼ˆç‚¹å‡»æµã€æ—¥å¿—ï¼‰ï¼Œé»˜è®¤æ¨¡å¼æ›´ä¼˜ï¼›å¯¹äºé‡è¦æ•°æ®ï¼Œå€¾å‘äºå®‰å…¨æ¨¡å¼ã€‚")]),s._v(" "),a("p",[s._v("mongo ä¸­ï¼Œ"),a("strong",[s._v("Journaling æ—¥å¿—")]),s._v("é»˜è®¤å¼€å¯ã€‚æ‰€æœ‰å†™æ“ä½œä¼šè¢«æäº¤åˆ°ä¸€ä¸ªåªèƒ½è¿½åŠ çš„æ—¥å¿—ä¸­ã€‚ä»¥åº”å¯¹æ•…éšœåçš„ï¼Œé‡å¯ä¿®å¤æœåŠ¡ã€‚")]),s._v(" "),a("h4",{attrs:{id:"æ•°æ®åº“æ‰©å±•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ•°æ®åº“æ‰©å±•"}},[s._v("#")]),s._v(" æ•°æ®åº“æ‰©å±•")]),s._v(" "),a("ul",[a("li",[s._v("å‚ç›´æ‰©å±•ï¼ˆå‘ä¸Šæ‰©å±•ï¼‰ï¼šå‡çº§ç¡¬ä»¶ï¼Œæ¥æé«˜å•ç‚¹æ€§èƒ½")]),s._v(" "),a("li",[s._v("æ°´å¹³æ‰©å±•ï¼ˆå‘å¤–æ‰©å±•ï¼‰ï¼šå°†æ•°æ®åº“åˆ†å¸ƒåˆ°å¤šå°æœºå™¨ï¼Œæ˜¯åŸºäº"),a("strong",[s._v("è‡ªåŠ¨åˆ†ç‰‡")]),s._v("ã€‚å…¶ä¸­ï¼Œå•ç‹¬çš„åˆ†ç‰‡ç”±ä¸€ä¸ªå‰¯æœ¬é›†ç»„æˆï¼Œè‡³å°‘æœ‰ 2 ä¸ªèŠ‚ç‚¹ï¼Œä¿è¯æ²¡æœ‰å•ç‚¹å¤±è´¥ã€‚")])]),s._v(" "),a("h3",{attrs:{id:"_3-æ ¸å¿ƒæœåŠ¡å™¨å’Œå·¥å…·"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-æ ¸å¿ƒæœåŠ¡å™¨å’Œå·¥å…·"}},[s._v("#")]),s._v(" 3. æ ¸å¿ƒæœåŠ¡å™¨å’Œå·¥å…·")]),s._v(" "),a("h4",{attrs:{id:"æ ¸å¿ƒæœåŠ¡å™¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ ¸å¿ƒæœåŠ¡å™¨"}},[s._v("#")]),s._v(" æ ¸å¿ƒæœåŠ¡å™¨")]),s._v(" "),a("p",[s._v("é€šè¿‡"),a("code",[s._v("mongod")]),s._v("å¯ä»¥è¿è¡Œæ ¸å¿ƒæœåŠ¡å™¨ã€‚æ•°æ®æ–‡ä»¶å­˜å‚¨åœ¨"),a("code",[s._v("/data/db")]),s._v("ä¸­ã€‚å¦‚æœä¸‹è½½ç¼–è¯‘ mongo çš„æºä»£ç ï¼Œéœ€è¦æ‰‹åŠ¨åˆ›å»º"),a("code",[s._v("/data/db")]),s._v("ï¼Œå¹¶ä¸”ä¸ºå…¶åˆ†é…æƒé™ã€‚")]),s._v(" "),a("p",[s._v("å…¶ä¸­ï¼Œmongo çš„"),a("strong",[s._v("å†…å­˜ç®¡ç†")]),s._v("æ˜¯ç”±æ“ä½œç³»ç»Ÿæ¥å¤„ç†çš„ã€‚æ•°æ®æ–‡ä»¶é€šè¿‡"),a("code",[s._v("mmap()")]),s._v("ç³»ç»Ÿ APIï¼Œæ˜ å°„æˆç³»ç»Ÿçš„è™šæ‹Ÿå†…å­˜ã€‚")]),s._v(" "),a("h4",{attrs:{id:"å‘½ä»¤è¡Œ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‘½ä»¤è¡Œ"}},[s._v("#")]),s._v(" å‘½ä»¤è¡Œ")]),s._v(" "),a("p",[s._v("æ˜¯åŸºäº JavaScript ç¼–å†™çš„ã€‚æ‰€ä»¥èƒ½çœ‹åˆ°å¾ˆå¤šé€šç”¨çš„è¯­æ³•ï¼Œä»¥åŠè¾“å‡ºçš„æ ¼å¼ã€‚")]),s._v(" "),a("h4",{attrs:{id:"æ•°æ®åº“é©±åŠ¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ•°æ®åº“é©±åŠ¨"}},[s._v("#")]),s._v(" æ•°æ®åº“é©±åŠ¨")]),s._v(" "),a("p",[s._v("é’ˆå¯¹å¤šä¸ªè¯­è¨€ï¼Œéƒ½æä¾›äº†"),a("strong",[s._v("é©±åŠ¨")]),s._v("ä½¿ç”¨ã€‚å¹¶ä¸”é£æ ¼å‡ ä¹ä¿æŒç»Ÿä¸€çš„ API æ¥å£ã€‚")]),s._v(" "),a("h4",{attrs:{id:"å‘½ä»¤è¡Œå·¥å…·"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‘½ä»¤è¡Œå·¥å…·"}},[s._v("#")]),s._v(" å‘½ä»¤è¡Œå·¥å…·")]),s._v(" "),a("p",[s._v("å®‰è£…åˆ° MaxOS åï¼Œå…¨å±€ä¼šå¤šå‡ºä»¥ä¸‹å‘½ä»¤ï¼š")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("mongodump")]),s._v("å’Œ"),a("code",[s._v("mongorestore")]),s._v("ï¼šå‰è€…ç”¨"),a("code",[s._v("BSON")]),s._v("æ ¼å¼ï¼Œæ¥å¤‡ä»½æ•°æ®åº“æ•°æ®ã€‚æ–¹ä¾¿åè€…æ¢å¤ã€‚")]),s._v(" "),a("li",[a("code",[s._v("mongoexport")]),s._v("å’Œ"),a("code",[s._v("mongoimport")]),s._v("ï¼šå¯¼å…¥å¯¼å‡º JSONã€CSV å’Œ TSV æ ¼å¼æ•°æ®ã€‚")])]),s._v(" "),a("h3",{attrs:{id:"_4-mongo-çš„åœºæ™¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-mongo-çš„åœºæ™¯"}},[s._v("#")]),s._v(" 4. Mongo çš„åœºæ™¯")]),s._v(" "),a("p",[s._v("é€‚ç”¨äº"),a("strong",[s._v("äº‹å…ˆæ— æ³•çŸ¥æ™“æ•°æ®ç»“æ„")]),s._v("çš„æ•°æ®ï¼Œæˆ–è€…"),a("strong",[s._v("æ•°æ®ç»“æ„ç»å¸¸ä¸ç¡®å®šæ€§è¾ƒå¤§")]),s._v("çš„æ•°æ®ã€‚")]),s._v(" "),a("p",[s._v("é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜é€‚ç”¨äº"),a("strong",[s._v("ä¸åˆ†æç›¸å…³çš„åœºæ™¯")]),s._v("ã€‚mongo æä¾›ä¸€ç§"),a("strong",[s._v("å›ºå®šé›†åˆ")]),s._v("ï¼Œå¸¸ç”¨äºæ—¥å¿—ï¼Œç‰¹ç‚¹æ˜¯"),a("strong",[s._v("åˆ†é…çš„å¤§å°å›ºå®š")]),s._v("ï¼Œç±»ä¼¼äºå¾ªç¯é˜Ÿåˆ—ã€‚")]),s._v(" "),a("h3",{attrs:{id:"_5-å±€é™"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-å±€é™"}},[s._v("#")]),s._v(" 5. å±€é™")]),s._v(" "),a("p",[s._v("ç”±äºä½¿ç”¨å†…å­˜æ˜ å°„ï¼Œ32 ä½ç³»ç»Ÿåªèƒ½å¯¹ 4GB å†…å­˜å¯»å€ã€‚ä¸€åŠå†…å­˜è¢« os å ç”¨ï¼Œé‚£ä¹ˆåªæœ‰ 2GB èƒ½ç”¨æ¥åšæ˜ å°„æ–‡ä»¶ã€‚æ‰€ä»¥ï¼Œ"),a("strong",[s._v("å¿…é¡»éƒ¨ç½²åœ¨ 64 ä½æ“ä½œç³»ç»Ÿä¸Š")]),s._v("ã€‚")]),s._v(" "),a("h2",{attrs:{id:"ç¨‹åºç¼–å†™åŸºç¡€"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç¨‹åºç¼–å†™åŸºç¡€"}},[s._v("#")]),s._v(" ç¨‹åºç¼–å†™åŸºç¡€")]),s._v(" "),a("p",[s._v("mongo é©±åŠ¨çš„ find æ–¹æ³•ï¼Œè¿”å›çš„æ˜¯"),a("strong",[s._v("æ¸¸æ ‡å¯¹è±¡")]),s._v("ï¼Œå¯ä»¥ç†è§£ä¸ºè¿­ä»£å™¨çš„ä¸‹æ ‡ã€‚åœ¨ NodeJS ä¸­ï¼Œå®ƒçš„åå­—å’Œç±»å‹æ˜¯"),a("code",[s._v("Cursor")]),s._v("ã€‚")]),s._v(" "),a("p",[s._v("åœ¨ Nodejs ä¸­ï¼Œ")]),s._v(" "),a("h3",{attrs:{id:"_1-é©±åŠ¨å·¥ä½œåŸç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-é©±åŠ¨å·¥ä½œåŸç†"}},[s._v("#")]),s._v(" 1. é©±åŠ¨å·¥ä½œåŸç†")]),s._v(" "),a("p",[s._v("ä¸»è¦æœ‰ 3 ä¸ªåŠŸèƒ½ï¼š")]),s._v(" "),a("ol",[a("li",[s._v("ç”Ÿæˆ MongoDB å¯¹è±¡çš„ IDï¼Œå®ƒæ˜¯å­˜å‚¨åœ¨"),a("code",[s._v("_id")]),s._v("å­—æ®µä¸­çš„é»˜è®¤å€¼")]),s._v(" "),a("li",[s._v("é©±åŠ¨ä¼šæŠŠç‰¹å®šè¯­è¨€çš„æ–‡æ¡£è¡¨è¿°ï¼Œå’Œ"),a("code",[s._v("BSON")]),s._v("äº’æ¢")]),s._v(" "),a("li",[s._v("ä½¿ç”¨ TCP å¥—æ¥å­—ä¸æ•°æ®åº“é€šä¿¡")])]),s._v(" "),a("h4",{attrs:{id:"å¯¹è±¡-id"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¯¹è±¡-id"}},[s._v("#")]),s._v(" å¯¹è±¡ ID")]),s._v(" "),a("p",[s._v("åœ¨è‡ªå¸¦çš„äº¤äº’å¼å‘½ä»¤è¡Œä¸­:")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ObjectId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ObjectId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5d9413867cc8dacf9247fe3e"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("å¯¹äºç”Ÿæˆçš„"),a("code",[s._v("5d9413867cc8dacf9247fe3e")]),s._v(":")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("- 5d941386 ï¼Œè¿™4ä¸ªå­—èŠ‚æ˜¯æ—¶é—´æˆ³ï¼Œå•ä½ç§’æ•°\n- 7cc8daï¼Œæœºå™¨ID\n- cf92ï¼Œè¿›ç¨‹ID\n- 47fe3eï¼Œè®¡æ•°å™¨\n")])])]),a("h3",{attrs:{id:"_2-å®‰å…¨å†™å…¥æ¨¡å¼-write-concern"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-å®‰å…¨å†™å…¥æ¨¡å¼-write-concern"}},[s._v("#")]),s._v(" 2. å®‰å…¨å†™å…¥æ¨¡å¼(Write Concern)")]),s._v(" "),a("p",[s._v("å¯¹æ‰€æœ‰çš„å†™æ“ä½œï¼ˆæ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤ï¼‰éƒ½èƒ½å¼€å¯æ­¤æ¨¡å¼ã€‚ä»¥æ­¤ä¿è¯ï¼Œæ“ä½œä¸€å®šåœ¨æ•°æ®åº“å±‚é¢ç”Ÿæ•ˆã€‚")]),s._v(" "),a("p",[s._v("åœ¨ v4.0 ä¸­ï¼Œä»¥ insert ä¸ºä¾‹ï¼Œæ–‡æ¡£å¦‚ä¸‹ï¼š")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("collection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("insert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("document or array "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("of")]),s._v(" documents"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n     writeConcern"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("document"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n     ordered"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("boolean"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("å…³äº Write Concern çš„è¯¦ç»†å‚æ•°ï¼Œå¯ä»¥çœ‹è¿™ç¯‡æ–‡æ¡£ï¼šhttps://docs.mongodb.com/manual/reference/write-concern/")]),s._v(" "),a("p",[s._v("å…¶ä¸­ï¼Œé‡è¦çš„æ˜¯"),a("code",[s._v("w")]),s._v(" å‚æ•°ï¼Œå®ƒå¯ä»¥æŒ‡å®šæ˜¯å¦ä½¿ç”¨åº”ç­”å†™å…¥ã€‚ç›®å‰é»˜è®¤æ˜¯ 1ï¼Œåº”ç­”å¼å†™å…¥ã€‚è®¾ç½®ä¸º 0ï¼Œåˆ™æ˜¯éåº”ç­”å¼ã€‚")]),s._v(" "),a("h2",{attrs:{id:"é¢å‘æ–‡æ¡£çš„æ•°æ®"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é¢å‘æ–‡æ¡£çš„æ•°æ®"}},[s._v("#")]),s._v(" é¢å‘æ–‡æ¡£çš„æ•°æ®")]),s._v(" "),a("h3",{attrs:{id:"_1-schema-è®¾è®¡åŸåˆ™"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-schema-è®¾è®¡åŸåˆ™"}},[s._v("#")]),s._v(" 1. Schema è®¾è®¡åŸåˆ™")]),s._v(" "),a("p",[s._v("è®¾è®¡æ•°æ®åº“ Schema å¼æ ¹æ®æ•°æ®åº“ç‰¹ç‚¹å’Œåº”ç”¨ç¨‹åºéœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œä¸ºæ•°æ®é›†é€‰æ‹©æœ€ä½³è¡¨è¿°çš„è¿‡ç¨‹ã€‚")]),s._v(" "),a("h3",{attrs:{id:"_2-è®¾è®¡ç”µå­å•†åŠ¡æ•°æ®æ¨¡å‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-è®¾è®¡ç”µå­å•†åŠ¡æ•°æ®æ¨¡å‹"}},[s._v("#")]),s._v(" 2. è®¾è®¡ç”µå­å•†åŠ¡æ•°æ®æ¨¡å‹")]),s._v(" "),a("h4",{attrs:{id:"ä¸€å¯¹å¤šï¼šäº§å“å’Œåˆ†ç±»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€å¯¹å¤šï¼šäº§å“å’Œåˆ†ç±»"}},[s._v("#")]),s._v(" ä¸€å¯¹å¤šï¼šäº§å“å’Œåˆ†ç±»")]),s._v(" "),a("p",[s._v("å‡è®¾ä¸€ä¸ªç”µå•†åœºæ™¯ï¼Œè¦å¯¹ä¸€ä¸ªå•†å“ doc è¿›è¡Œè®¾è®¡ã€‚å¯¹äºå•†å“ï¼Œå®ƒæœ‰å¤šä¸ªåˆ†ç±» categoryï¼Œå› æ­¤éœ€è¦"),a("strong",[s._v("ä¸€å¯¹å¤šæ“ä½œ")]),s._v("ï¼ŒåŒæ—¶ï¼Œmongo ä¸æ”¯æŒè”ç»“æ“ä½œï¼ˆjoinï¼‰ã€‚")]),s._v(" "),a("p",[s._v("å› æ­¤è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œåœ¨å•†å“çš„ä¸€ä¸ªå­—æ®µä¸­ï¼Œä¿å­˜"),a("strong",[s._v("åˆ†ç±»æŒ‡é’ˆ")]),s._v("çš„æ•°ç»„ã€‚è¿™é‡Œçš„æŒ‡é’ˆï¼Œå°±æ˜¯ mongo ä¸­çš„å¯¹è±¡ IDã€‚")]),s._v(" "),a("p",[s._v("ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.products.find()\n{ "_id" : ObjectId("5d9423257cc8dacf9247fe41"), "categories" : [ ObjectId("5d9423017cc8dacf9247fe3f") ] }\n> db.categories.find({})\n{ "_id" : ObjectId("5d9423017cc8dacf9247fe3f"), "name" : "åˆ†ç±»1" }\n{ "_id" : ObjectId("5d9423037cc8dacf9247fe40"), "name" : "åˆ†ç±»2" }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h4",{attrs:{id:"ä¸€å¯¹å¤šï¼šç”¨æˆ·ä¸è®¢å•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€å¯¹å¤šï¼šç”¨æˆ·ä¸è®¢å•"}},[s._v("#")]),s._v(" ä¸€å¯¹å¤šï¼šç”¨æˆ·ä¸è®¢å•")]),s._v(" "),a("p",[s._v("å’Œå‰é¢çš„å…³ç³»ä¸åŒï¼Œè¿™é‡Œçš„â€œå¤šâ€ä½“ç°åœ¨â€œè®¢å•â€ä¸Šã€‚è¿™é‡Œçš„è®¢å•ä¸­ï¼Œä¿å­˜ç€æŒ‡å‘ç”¨æˆ·çš„æŒ‡é’ˆã€‚")]),s._v(" "),a("h4",{attrs:{id:"è¯„è®º"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è¯„è®º"}},[s._v("#")]),s._v(" è¯„è®º")]),s._v(" "),a("p",[s._v("æ¯ä¸ªäº§å“ä¼šæœ‰å¤šä¸ªè¯„è®ºï¼Œè€Œæ¯ä¸ªè¯„è®ºï¼Œå¯èƒ½ä¼šæœ‰ç‚¹èµäººåˆ—è¡¨ã€‚å½“è¦å±•ç¤ºè¿”å›ç»™å‰ç«¯çš„æ—¶å€™ï¼Œéœ€è¦è·å–äº§å“è¯„è®ºï¼Œå¹¶ä¸”è·å–ç‚¹èµäººåˆ—è¡¨ã€‚")]),s._v(" "),a("p",[s._v("æ–¹æ¡ˆ 1ï¼šç‚¹èµäººåˆ—è¡¨ï¼Œä¿å­˜ç€ç”±æŒ‡é’ˆç»„æˆçš„é›†åˆã€‚å¯ä»¥å…ˆæŸ¥è¯¢äº§å“è¯„è®ºåï¼Œå†å¯¹ç‚¹èµåš 2 æ¬¡æŸ¥è¯¢ã€‚")]),s._v(" "),a("p",[s._v("æ–¹æ¡ˆ 2ï¼šç”±äºä»…éœ€è¦ç‚¹èµäººçš„å¤´åƒå’Œåç§°ï¼ˆå°‘é‡ä¿¡æ¯ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨"),a("strong",[s._v("å»æ­£è§„åŒ–")]),s._v("ï¼Œä¸å†ä¿å­˜æŒ‡é’ˆï¼Œè€Œæ˜¯ç®€å•ä¿¡æ¯ã€‚")]),s._v(" "),a("p",[s._v("ä¸Šé¢ 2 ç§æ–¹æ¡ˆï¼Œéƒ½å¯ä»¥é˜²æ­¢é‡å¤ç‚¹èµçš„å‘ç”Ÿã€‚")]),s._v(" "),a("h3",{attrs:{id:"_3-å…·ä½“ç»†èŠ‚"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-å…·ä½“ç»†èŠ‚"}},[s._v("#")]),s._v(" 3. å…·ä½“ç»†èŠ‚")]),s._v(" "),a("h4",{attrs:{id:"æ•°æ®åº“"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ•°æ®åº“"}},[s._v("#")]),s._v(" æ•°æ®åº“")]),s._v(" "),a("p",[s._v("å³ä½¿ä½¿ç”¨"),a("code",[s._v("use")]),s._v("åˆ‡æ¢ä¸€ä¸ªæ–°çš„æ•°æ®åº“ï¼Œå¦‚æœæ²¡æœ‰ insert æ•°æ®ï¼Œè¯¥æ•°æ®åº“å¹¶ä¸ä¼šåˆ›å»ºã€‚")]),s._v(" "),a("p",[s._v("mongodb ä¼šä¸ºæ•°æ®ã€é›†åˆã€ç´¢å¼•è¿›è¡Œç©ºé—´åˆ†é…ï¼Œå¹¶ä¸”é‡‡å–çš„æ˜¯"),a("strong",[s._v("é¢„åˆ†é…")]),s._v("çš„æ–¹å¼ï¼Œæ¯æ¬¡ç©ºé—´ä¸å¤Ÿçš„æ—¶å€™ï¼Œæ‰©å…… 2 å€ã€‚")]),s._v(" "),a("p",[s._v("é€šè¿‡ "),a("code",[s._v("db.stats()")]),s._v(" å¯ä»¥æŸ¥çœ‹å½“å‰ db çš„çŠ¶æ€ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("stats")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"db"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"info_keeper"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"collections"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"views"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"objects"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"avgObjSize"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("255.8181818181818")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dataSize"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2814")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ•°æ®åº“ä¸­BSONå¯¹è±¡å®é™…å¤§å°")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"storageSize"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("86016")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åŒ…å«äº†é›†åˆå¢é•¿çš„é¢„ç•™ç©ºé—´å’Œæœªåˆ†é…çš„å·²åˆ é™¤ç©ºé—´")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"numExtents"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"indexes"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"indexSize"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("155648")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ•°æ®åº“ç´¢å¼•å¤§å°çš„ç©ºé—´")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fsUsedSize"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("86272356352")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fsTotalSize"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("250685575168")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ok"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("h4",{attrs:{id:"é›†åˆ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é›†åˆ"}},[s._v("#")]),s._v(" é›†åˆ")]),s._v(" "),a("p",[s._v("1ã€é‡å‘½åæ“ä½œï¼š")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" use test\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("orders"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("renameCollection")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"orders2014"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("2ã€å›ºå®šé›†åˆ")]),s._v(" "),a("p",[s._v("å¯¹åº”æ—¥å¿—ç»Ÿè®¡ä¹‹ç±»çš„ã€"),a("strong",[s._v("åªæœ‰æœ€è¿‘çš„æ•°æ®æ‰æœ‰ä»·å€¼")]),s._v("çš„åœºæ™¯ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨"),a("strong",[s._v("å›ºå®šé›†åˆ")]),s._v("ï¼šä¸€æ—¦å®¹é‡åˆ°ä¸Šé™ï¼Œåç»­æ’å…¥ä¼šé€æ­¥è¦†ç›–æœ€å…ˆæ’å…¥çš„æ–‡æ¡£ã€‚")]),s._v(" "),a("p",[s._v("åˆ›å»ºæ—¶å€™ï¼Œéœ€è¦åŒæ—¶æŒ‡å®š"),a("code",[s._v("createCollection")]),s._v("çš„ capped å’Œ size å‚æ•°ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.createCollection('logs',{ capped : true, size : 5242880 })\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("ä¸ºäº†æ€§èƒ½ä¼˜åŒ–ï¼Œmongo"),a("strong",[s._v("ä¸ä¼šä¸ºå›ºå®šé›†åˆåˆ›å»ºé’ˆå¯¹"),a("code",[s._v("_id")]),s._v("çš„ç´¢å¼•")]),s._v("ã€‚åŒæ—¶ï¼Œä¸èƒ½ä»ä¸­åˆ é™¤ docï¼Œä¹Ÿä¸èƒ½æ‰§è¡Œä»»ä½•æ›´æ”¹æ–‡æ¡£å¤§å°çš„æ›´æ–°æ“ä½œã€‚")]),s._v(" "),a("p",[s._v("3ã€é”®åé€‰æ‹©")]),s._v(" "),a("p",[a("strong",[s._v("æ…é‡é€‰æ‹©é”®å")]),s._v("ï¼Œä¾‹å¦‚ï¼Œç”¨"),a("code",[s._v("dob")]),s._v("ä»£æ›¿"),a("code",[s._v("date_of_birth")]),s._v("ï¼Œä¸€ä¸ªæ–‡æ¡£å¯ä»¥çœä¸‹ 10 å­—èŠ‚ã€‚")]),s._v(" "),a("h2",{attrs:{id:"æŸ¥è¯¢å’Œèšåˆ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æŸ¥è¯¢å’Œèšåˆ"}},[s._v("#")]),s._v(" æŸ¥è¯¢å’Œèšåˆ")]),s._v(" "),a("h3",{attrs:{id:"_1-æŸ¥è¯¢å¸¸è§æŠ€å·§"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-æŸ¥è¯¢å¸¸è§æŠ€å·§"}},[s._v("#")]),s._v(" 1. æŸ¥è¯¢å¸¸è§æŠ€å·§")]),s._v(" "),a("p",[a("strong",[s._v("åˆ†é¡µæŸ¥è¯¢")]),s._v("å¯ä»¥é€šè¿‡"),a("code",[s._v("skip")]),s._v("å’Œ"),a("code",[s._v("limit")]),s._v("é…åˆä½¿ç”¨å®ç°ã€‚")]),s._v(" "),a("p",[a("strong",[s._v("ç©ºå€¼æŸ¥è¯¢")]),s._v("å¯ä»¥é€šè¿‡é©±åŠ¨çš„ç©ºå€¼å­—é¢é‡å®ç°ï¼Œæ¯”å¦‚åœ¨ node ä¸­ï¼Œæƒ³æŸ¥è¯¢"),a("code",[s._v("logs")]),s._v("ä¸­ä¸åŒ…å«"),a("code",[s._v("name")]),s._v("å­—æ®µçš„è®°å½•ï¼š"),a("code",[s._v("db.logs.find({ name: null })")]),s._v("ã€‚")]),s._v(" "),a("p",[a("strong",[s._v("å‡å°‘åºåˆ—åŒ–å’Œç½‘ç»œä¼ è¾“")]),s._v("ï¼Œå¯ä»¥é€šè¿‡ç»™å®š find çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ¥é€‰å®šæ•°æ®åº“è¿”å›ç»™é©±åŠ¨çš„æ–‡æ¡£çš„å­—æ®µï¼Œæ¯”å¦‚ï¼š"),a("code",[s._v("db.products.find({}, {_id: 1})")]),s._v("ã€‚è¿™æ¡å‘½ä»¤ï¼Œåªè¿”å›æ–‡æ¡£çš„"),a("code",[s._v("_id")]),s._v("å­—æ®µã€‚")]),s._v(" "),a("p",[a("strong",[s._v("å¤åˆç´¢å¼•")]),s._v("ï¼Œå¤åˆç´¢å¼•çš„è®¾å®šï¼Œéµå¾ªç€ã€Œä»å‡†ç¡®åˆ°å®½æ³›ã€çš„è§„åˆ™ã€‚æ¯”å¦‚å¯¹äºè®¢å•è®°å½•ï¼Œæœ‰ç€ä¸‹å•äººå’Œæ—¶é—´ 2 ä¸ªå­—æ®µã€‚åº”è¯¥å…ˆä¸ºä¸‹å•äººå­—æ®µè®¾ç½®ç´¢å¼•ï¼Œå†ä¸ºæ—¶é—´å­—æ®µè®¾ç½®ç´¢å¼•ã€‚å¯ä»¥ç†è§£ä¸ºå‰è€…æ˜¯ç²¾ç¡®æŸ¥æ‰¾ï¼Œå¯ä»¥å¤§å¤§ç¼©å°æŸ¥æ‰¾ç»“æœé›†ï¼›åè€…æ˜¯èŒƒå›´æŸ¥æ‰¾ã€‚")]),s._v(" "),a("p",[a("strong",[s._v("åµŒå¥—å­—æ®µæŸ¥è¯¢")]),s._v("ï¼Œå¯¹äºè´Ÿè´£å¯¹è±¡å­—æ®µçš„æŸ¥è¯¢ï¼Œç›´æ¥é€šè¿‡"),a("code",[s._v(".")]),s._v("è¿ç®—ç¬¦å³å¯ã€‚ä¾‹å¦‚ï¼š"),a("code",[s._v("db.demos.find({a: {b : 1}})")]),s._v("å’Œ"),a("code",[s._v('db.demos.find({"a.b": 1})')]),s._v(" æ˜¯ç­‰æ•ˆçš„ã€‚")]),s._v(" "),a("h3",{attrs:{id:"_2-å¸¸è§æŸ¥è¯¢è¯­è¨€"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-å¸¸è§æŸ¥è¯¢è¯­è¨€"}},[s._v("#")]),s._v(" 2. å¸¸è§æŸ¥è¯¢è¯­è¨€")]),s._v(" "),a("p",[s._v("MongoDB çš„æŸ¥è¯¢æœ¬è´¨ï¼šå®ä¾‹åŒ–äº†ä¸€ä¸ªæ¸¸æ ‡ï¼Œå¹¶è·å–å®ƒçš„ç»“æœé›†ã€‚")]),s._v(" "),a("h4",{attrs:{id:"èŒƒå›´æŸ¥è¯¢"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#èŒƒå›´æŸ¥è¯¢"}},[s._v("#")]),s._v(" èŒƒå›´æŸ¥è¯¢")]),s._v(" "),a("p",[s._v("èŒƒå›´æ“ä½œç¬¦ç”¨æ³•å¾ˆç®€å•ï¼Œä½†æ³¨æ„ï¼šä¸è¦åœ¨èŒƒå›´æŸ¥æ‰¾æ—¶å€™è¯¯ç”¨"),a("strong",[s._v("é‡å¤æœç´¢é”®")]),s._v("ã€‚")]),s._v(" "),a("p",[s._v("é”™è¯¯ï¼š"),a("code",[s._v("db.users.find({age: { $gte: 0 }, age: { $lte: 30 } })")])]),s._v(" "),a("p",[s._v("æ­£ç¡®ï¼š"),a("code",[s._v("db.users.find({age: {$gte: 0, $lte: 30}})")])]),s._v(" "),a("h4",{attrs:{id:"é›†åˆæ“ä½œ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é›†åˆæ“ä½œ"}},[s._v("#")]),s._v(" é›†åˆæ“ä½œ")]),s._v(" "),a("p",[s._v("é›†åˆæ“ä½œç¬¦ä¸€å…±æœ‰ 3 ä¸ªï¼š"),a("code",[s._v("$in")]),s._v("ã€"),a("code",[s._v("$all")]),s._v("ã€"),a("code",[s._v("$nin")]),s._v("ã€‚")]),s._v(" "),a("p",[s._v("in å’Œ nin æ˜¯ä¸€å¯¹ï¼Œin ç›¸å½“äºä½¿ç”¨å¤šä¸ª OR æ“ä½œç¬¦ï¼š"),a("code",[s._v("db.products.find({'tags': {$in: [ObjectId('...'), ObjectId('...')]}})")])]),s._v(" "),a("p",[s._v("all çš„ä½œç”¨å±æ€§ï¼Œå¿…é¡»æ˜¯æ•°ç»„å½¢å¼ï¼š"),a("code",[s._v("db.products.find({tags: {$all: ['a', 'b']}})")])]),s._v(" "),a("p",[s._v("âš ï¸ æ³¨æ„ï¼šin å’Œ all å¯ä»¥åˆ©ç”¨ç´¢å¼•ï¼›nin ä¸èƒ½åˆ©ç”¨ç´¢å¼•ï¼Œåªèƒ½ä½¿ç”¨"),a("strong",[s._v("é›†åˆæ‰«æ")]),s._v("ã€‚è¿™å’Œ BTree ç»“æ„æœ‰å…³ã€‚")]),s._v(" "),a("h4",{attrs:{id:"å¸ƒå°”æ“ä½œ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å¸ƒå°”æ“ä½œ"}},[s._v("#")]),s._v(" å¸ƒå°”æ“ä½œ")]),s._v(" "),a("p",[s._v("å¸¸è§çš„æœ‰ï¼š"),a("code",[s._v("$ne")]),s._v("ã€"),a("code",[s._v("$not")]),s._v("ã€ "),a("code",[s._v("$or")]),s._v("ã€ "),a("code",[s._v("$and")]),s._v("ã€"),a("code",[s._v("$exists")]),s._v("ã€‚åŒæ ·çš„ï¼Œ"),a("code",[s._v("$ne")]),s._v("ä¸èƒ½åˆ©ç”¨ç´¢å¼•ã€‚")]),s._v(" "),a("p",[s._v("å¯¹äº not çš„ä½¿ç”¨ï¼Œå¦‚æœä½¿ç”¨çš„æ“ä½œç¬¦æˆ–è€…æ­£åˆ™è¡¨è¾¾å¼ä¸å­˜åœ¨å¦å®šå½¢å¼ï¼Œæ‰é…åˆ notã€‚ä¾‹å¦‚å¤§äºï¼Œå°±æœ‰å°äºç­‰äºæ“ä½œç¬¦ã€‚")]),s._v(" "),a("p",[s._v("å¯¹ä¸ or çš„ä½¿ç”¨ï¼Œor å¯ä»¥"),a("strong",[s._v("è¡¨ç¤ºä¸åŒé”®çš„å€¼çš„å…³ç³»")]),s._v("ï¼Œè€Œ in åªèƒ½è¡¨ç¤ºä¸€ä¸ªé”®çš„å€¼çš„å…³ç³»ã€‚ä¾‹å¦‚ï¼š"),a("code",[s._v("db.products.find({ $or: [{ name: 'a' }, { name: 'b' }] })")])]),s._v(" "),a("h4",{attrs:{id:"å­æ–‡æ¡£"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å­æ–‡æ¡£"}},[s._v("#")]),s._v(" å­æ–‡æ¡£")]),s._v(" "),a("p",[s._v("å¯¹äºå†…åµŒå¯¹è±¡åŒ¹é…ï¼Œç”¨"),a("code",[s._v(".")]),s._v("è¿ç®—ç¬¦å³å¯ï¼Œæ­£å¦‚å‰é¢çš„åµŒå¥—å­—æ®µæŸ¥è¯¢æ‰€è¿°ã€‚")]),s._v(" "),a("p",[a("strong",[s._v("ä¸æ¨è")]),s._v("å¯¹äºæ•´ä¸ªå¯¹è±¡çš„æŸ¥è¯¢ï¼Œéœ€è¦ä¸¥æ ¼ä¿è¯æŸ¥è¯¢å­—æ®µçš„é¡ºåºã€‚")]),s._v(" "),a("h4",{attrs:{id:"æ•°ç»„"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ•°ç»„"}},[s._v("#")]),s._v(" æ•°ç»„")]),s._v(" "),a("p",[s._v("å¦‚æœæ•°ç»„ä¸­å…ƒç´ æ˜¯åŸºç¡€å¯¹è±¡ï¼Œé‚£ä¹ˆç›´æ¥æŸ¥è¯¢å³å¯ã€‚mongo è¯†åˆ«å­—æ®µæ˜¯æ•°ç»„ç±»å‹ï¼Œä¼šè‡ªåŠ¨æŸ¥è¯¢å­—æ®µæ˜¯å¦ä½äºå…¶ä¸­ã€‚")]),s._v(" "),a("p",[s._v("ä¾‹å¦‚ï¼š")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.products.insert"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("tags: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'a'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'b'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nWriteResult"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nInserted"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.products.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("tags: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'a'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5d948025da0946c664997712"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tags"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"b"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("å¦‚æœæ•°ç»„ä¸­å…ƒç´ æ˜¯è´Ÿè´£å¯¹è±¡ï¼Œå¯ä»¥å€ŸåŠ©"),a("code",[s._v(".")]),s._v("è¿ç®—ç¬¦è¿›è¡Œè®¿é—®ï¼š")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.products.insert"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("address: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("name: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'home'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nWriteResult"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nInserted"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.products.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"address.name"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'home'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5d948055da0946c664997713"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"address"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"home"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("åŒæ ·åœ°ï¼Œä½ ä¹Ÿå¯ä»¥æŒ‡å®šé’ˆå¯¹ç‰¹å®šé¡ºåºçš„æ•°ç»„å…ƒç´ ï¼š")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.products.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"address.0.name"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'home'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5d948055da0946c664997713"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"address"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"home"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("å¦‚æœè¦åŒæ—¶å°†"),a("strong",[s._v("å¤šä¸ªæ¡ä»¶é™åˆ¶åœ¨åŒä¸€ä¸ªå­æ–‡æ¡£")]),s._v("ä¸Šï¼Œä¸‹é¢æ˜¯é”™è¯¯å’Œæ­£ç¡®çš„åšæ³• ğŸ‘‡")]),s._v(" "),a("p",[s._v("é”™è¯¯ï¼š"),a("code",[s._v("db.products.find({\"address.name\": 'home', 'address.state': 'NY'})")])]),s._v(" "),a("p",[s._v("æ­£ç¡®ï¼š"),a("code",[s._v("db.products.find({address: {$elemMatch: {name: 'home', state: 'NY'} }})")])]),s._v(" "),a("h4",{attrs:{id:"javascript-æŸ¥è¯¢"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#javascript-æŸ¥è¯¢"}},[s._v("#")]),s._v(" Javascript æŸ¥è¯¢")]),s._v(" "),a("p",[s._v("å¯¹äºä¸€äº›å¤æ‚æŸ¥è¯¢ï¼Œå€ŸåŠ©"),a("code",[s._v("$where")]),s._v("å¯ä»¥ä½¿ç”¨ js è¡¨è¾¾å¼ã€‚è¿˜æ˜¯ä»¥åˆšæ‰çš„æ•°æ®ä¸ºä¾‹ï¼š")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.products.find"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$where")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"function() {return this.address && this.address.length}"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5d948055da0946c664997713"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"address"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"home"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œéœ€è¦å¯åŠ¨ js è§£é‡Šå™¨å’Œä¸Šä¸‹æ–‡ï¼Œå› æ­¤"),a("strong",[s._v("å¼€é”€å¤§")]),s._v("ã€‚åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå°½é‡å¸¦ä¸Šå…¶ä»–æ ‡å‡†æŸ¥è¯¢æ“ä½œï¼Œæ¥ç¼©å°æŸ¥è¯¢èŒƒå›´ã€‚")]),s._v(" "),a("p",[s._v("é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰æ³¨å…¥æ”»å‡»çš„å¯èƒ½ã€‚ä¸»è¦ä½“ç°åœ¨é©±åŠ¨ä½¿ç”¨æ—¶å€™ï¼Œå¦‚æœåç«¯ä¼ ç»™ db çš„å­—æ®µæ˜¯æ²¡åšæ£€éªŒçš„ï¼Œå¯èƒ½å‘ç”Ÿæ³¨å…¥æ”»å‡»ã€‚")]),s._v(" "),a("h4",{attrs:{id:"æ­£åˆ™è¡¨è¾¾å¼"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ­£åˆ™è¡¨è¾¾å¼"}},[s._v("#")]),s._v(" æ­£åˆ™è¡¨è¾¾å¼")]),s._v(" "),a("p",[s._v("ä¸»è¦ä½“ç°åœ¨é©±åŠ¨ä½¿ç”¨ä¸Šã€‚")]),s._v(" "),a("p",[s._v("å¦‚æœæ”¯æŒ js çš„æ­£åˆ™ï¼Œé‚£ä¹ˆå¯ä»¥: "),a("code",[s._v("find({text: /best/i})")])]),s._v(" "),a("p",[s._v("å¦‚æœä¸æ”¯æŒï¼Œé‚£ä¹ˆï¼š"),a("code",[s._v("find({text: {$regex: 'best', $options: 'i'}})")])]),s._v(" "),a("h4",{attrs:{id:"ç±»å‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç±»å‹"}},[s._v("#")]),s._v(" ç±»å‹")]),s._v(" "),a("p",[s._v("é€šè¿‡"),a("code",[s._v("$type")]),s._v("ï¼Œå¯ä»¥æ ¹æ®æŒ‡å®šå­—æ®µç±»å‹è¿›è¡ŒæŸ¥è¯¢ã€‚ä¸åŒçš„å€¼ï¼Œä»£è¡¨ä¸åŒçš„ç±»å‹ã€‚è¯·è§å®˜æ–¹æ–‡æ¡£ã€‚")]),s._v(" "),a("h3",{attrs:{id:"_3-æŸ¥è¯¢é€‰é¡¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-æŸ¥è¯¢é€‰é¡¹"}},[s._v("#")]),s._v(" 3. æŸ¥è¯¢é€‰é¡¹")]),s._v(" "),a("h4",{attrs:{id:"æŠ•å½±"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æŠ•å½±"}},[s._v("#")]),s._v(" æŠ•å½±")]),s._v(" "),a("p",[s._v("1ã€ä½¿ç”¨é€‰æ‹©å­—æ®µè¿›è¡Œè¿”å›ï¼Œé™ä½ç½‘ç»œä¼ è¾“ï¼š"),a("code",[s._v("find")]),s._v("ç»™å®šç¬¬äºŒä¸ªå‚æ•°ã€‚")]),s._v(" "),a("p",[s._v("2ã€è¿”å›ä¿å­˜åœ¨ç»“æœæ•°ç»„ä¸­çš„æŸä¸ªèŒƒå›´çš„å€¼ï¼š"),a("code",[s._v("$slice([start, limit])")]),s._v("ã€‚ä¾‹å¦‚ï¼š"),a("code",[s._v("db.products.find({}, { comments: {$slice: 12}})")])]),s._v(" "),a("h4",{attrs:{id:"æ’åº"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ’åº"}},[s._v("#")]),s._v(" æ’åº")]),s._v(" "),a("p",[s._v("èƒ½å¤Ÿå¯¹"),a("strong",[s._v("å¤šä¸ªå­—æ®µ")]),s._v("è¿›è¡Œå‡åº/é™åºæ’åˆ—ã€‚ä¾‹å¦‚ï¼š"),a("code",[s._v("db.comments.find().sort({rating: -1, votes: -1})")])]),s._v(" "),a("h4",{attrs:{id:"skip-å’Œ-limit"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#skip-å’Œ-limit"}},[s._v("#")]),s._v(" skip å’Œ limit")]),s._v(" "),a("p",[s._v("å¦‚æœå‘ skip ä¼ å…¥å¾ˆå¤§çš„å€¼ï¼Œéœ€è¦æ‰«æåŒç­‰æ•°é‡çš„æ–‡æ¡£ï¼Œæµªè´¹èµ„æºã€‚")]),s._v(" "),a("p",[s._v("æœ€å¥½çš„æ–¹æ³•æ˜¯ï¼šé€šè¿‡æŸ¥è¯¢æ¡ä»¶ï¼Œç¼©å°è¦æ‰«æçš„æ–‡æ¡£ã€‚")]),s._v(" "),a("h3",{attrs:{id:"_4-èšåˆæŒ‡ä»¤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-èšåˆæŒ‡ä»¤"}},[s._v("#")]),s._v(" 4. èšåˆæŒ‡ä»¤")]),s._v(" "),a("p",[s._v("åœ¨ v2 çš„ç‰ˆæœ¬ä¸­ï¼Œmongo åªèƒ½é€šè¿‡ mapã€reduce ç­‰åŸºç¡€æ“ä½œæ¥æ”¯æŒèšåˆæœç´¢ã€‚ä½†åœ¨ v3 çš„ç‰ˆæœ¬åï¼Œmongo æœ¬èº«æä¾›äº†ä¸°å¯Œçš„èšåˆé˜¶æ®µ("),a("a",{attrs:{href:"https://docs.mongodb.com/manual/reference/operator/aggregation-pipeline",target:"_blank",rel:"noopener noreferrer"}},[s._v("aggregation pipeline"),a("OutboundLink")],1),s._v(")å’Œèšåˆè¿ç®—ç¬¦("),a("a",{attrs:{href:"https://docs.mongodb.com/manual/reference/operator/aggregation/",target:"_blank",rel:"noopener noreferrer"}},[s._v("aggregation operator"),a("OutboundLink")],1),s._v(")ã€‚")]),s._v(" "),a("p",[s._v("ä»¥"),a("code",[s._v("$group")]),s._v("å’Œ"),a("code",[s._v("$sum")]),s._v("ä¸ºä¾‹ï¼Œæ’å…¥äº† a å’Œ b ä¸¤ç§å”®å–è´§ç‰©ä»¥åŠä»·é’±ï¼š")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.sales."),a("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("find")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5d98ca8094ffea590a8a85c6"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"coin"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5d98ca8694ffea590a8a85c7"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"coin"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" ObjectId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5d98ca9094ffea590a8a85c8"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"b"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"coin"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("800")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("åˆ©ç”¨èšåˆæ“ä½œï¼Œå°±å¯ä»¥ä¾¿æ·ç®—å‡ºæ¯ç§è´§ç‰©çš„æ€»ä»·ï¼š")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db.sales.aggregate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$group")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" _id: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$name")]),s._v('"')]),s._v(", total: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$sum")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$coin")]),s._v('"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"b"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"total"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("800")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"total"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("æœ€åè¯´ä¸€ä¸‹ï¼Œèšåˆçš„æ„ä¹‰åœ¨äºæ•°æ®åº“æä¾›ç»™ä½¿ç”¨è€…æ­¤ç§åŠŸèƒ½ä»¥åŠç›¸å…³ä¼˜åŒ–ã€‚å½“ç„¶ï¼Œä½¿ç”¨è€…å®Œå…¨å¯ä»¥åœ¨é€»è¾‘å±‚é¢æŸ¥è¯¢åˆ°éœ€è¦çš„é›†åˆï¼Œä»£ç ä¸­è¿›è¡Œè®¡ç®—ã€‚ä½†å¯¹äºæœåŠ¡çš„æä¾›å•†ï¼Œå®Œæ•´çš„æœåŠ¡æ˜¯å¿…ä¸å¯å°‘çš„ã€‚")]),s._v(" "),a("h2",{attrs:{id:"æ›´æ–°ã€åŸå­æ“ä½œä¸åˆ é™¤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ›´æ–°ã€åŸå­æ“ä½œä¸åˆ é™¤"}},[s._v("#")]),s._v(" æ›´æ–°ã€åŸå­æ“ä½œä¸åˆ é™¤")]),s._v(" "),a("h3",{attrs:{id:"_1-æ–‡æ¡£æ›´æ–°å…¥é—¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-æ–‡æ¡£æ›´æ–°å…¥é—¨"}},[s._v("#")]),s._v(" 1. æ–‡æ¡£æ›´æ–°å…¥é—¨")]),s._v(" "),a("p",[s._v("æ–‡æ¡£æ›´æ–°åˆ†ä¸ºï¼šæ›¿æ¢æ›´æ–°å’Œé’ˆå¯¹æ€§æ›´æ–°ã€‚ç›¸è¾ƒè€Œè¨€ï¼Œ"),a("strong",[s._v("é’ˆå¯¹æ€§æ›´æ–°")]),s._v("å…·æœ‰æ€§èƒ½å¥½ã€ä¼ è¾“æ•°æ®å°‘å’Œå…è®¸åŸå­æ€§æ›´æ–°çš„ä¼˜ç‚¹ã€‚")]),s._v(" "),a("p",[s._v("åˆ©ç”¨"),a("code",[s._v("$set")]),s._v("å’Œ"),a("code",[s._v("$push")]),s._v("å¯ä»¥é’ˆå¯¹æ–‡æ¡£å’Œå…¶ä¸­çš„æ•°ç»„å­—æ®µè¿›è¡Œé’ˆå¯¹æ€§æ›´æ–°ï¼Œä¸‹é¢æ˜¯é’ˆå¯¹æ€§æ›´æ–°çš„ä¾‹å­ï¼š")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("db.products.update"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" _id: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$set")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        quantity: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("å¦‚æœæ˜¯æ›¿æ¢æ›´æ–°ï¼Œé‡åˆ°å¢åŠ è®¡æ•°å™¨å€¼ä¹‹ç±»çš„åœºæ™¯ï¼Œåœ¨ä¸ä½¿ç”¨ä¹è§‚é”çš„æƒ…å†µä¸‹ï¼Œæ— æ³•ä¿è¯åŸå­æ€§æ›´æ–°ã€‚å› ä¸ºéœ€è¦å…ˆè¯»å‡ºæ•°æ®ï¼Œç„¶åå†æ›´æ–°ã€‚æ­¤è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šæœ‰å…¶ä»–å¹¶å‘ç¨‹åºé‡å†™å­—æ®µï¼Œä»è€Œé€ æˆè„æ•°æ®ã€‚")]),s._v(" "),a("p",[s._v("ä»¥æ›´æ–°è®¡æ•°å™¨çš„é’ˆå¯¹æ€§æ›´æ–°ä¸ºä¾‹ï¼š")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("db.products.update"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" sku: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"abc123"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$inc")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" quantity: -1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"_2-ç”µå­å•†åŠ¡æ•°æ®æ¨¡å‹ä¸­çš„æ›´æ–°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-ç”µå­å•†åŠ¡æ•°æ®æ¨¡å‹ä¸­çš„æ›´æ–°"}},[s._v("#")]),s._v(" 2. ç”µå­å•†åŠ¡æ•°æ®æ¨¡å‹ä¸­çš„æ›´æ–°")]),s._v(" "),a("h4",{attrs:{id:"å†—ä½™å­—æ®µè®¾è®¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å†—ä½™å­—æ®µè®¾è®¡"}},[s._v("#")]),s._v(" å†—ä½™å­—æ®µè®¾è®¡")]),s._v(" "),a("p",[s._v("å¯¹äºä¸€äº›å¸¸è§çš„ç»“æœï¼Œæ¯”å¦‚ï¼šæ€»æ•°ã€å¹³å‡å€¼ç­‰ã€‚ä¸ºäº†é¿å…æ¯æ¬¡éƒ½"),a("strong",[s._v("é‡æ–°èšåˆè¿ç®—")]),s._v("ï¼Œå¯ä»¥åœ¨æ–‡æ¡£ä¸­"),a("strong",[s._v("ä¿å­˜é¢å¤–çš„å­—æ®µç¼“å­˜")]),s._v("ç›¸å…³æ•°æ®ã€‚")]),s._v(" "),a("p",[s._v("ä¹‹åçš„ä¸šåŠ¡æŸ¥è¯¢ï¼Œä»…ä»…éœ€è¦æŸ¥è¯¢ä¸€æ¬¡å³å¯ã€‚")]),s._v(" "),a("h4",{attrs:{id:"æ“ä½œç¬¦"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ“ä½œç¬¦"}},[s._v("#")]),s._v(" "),a("code",[s._v("$")]),s._v("æ“ä½œç¬¦")]),s._v(" "),a("p",[s._v("ä½œç”¨ï¼šç¡®å®šæ•°ç»„ä¸­ä¸€ä¸ªè¦è¢«æ›´æ–°çš„å…ƒç´ çš„ä½ç½®ï¼Œè€Œä¸ç”¨å…·ä½“æŒ‡å®šè¯¥å…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä½ç½®ã€‚")]),s._v(" "),a("p",[s._v("å¦‚ä¸‹æ‰€ç¤ºï¼Œä¸éœ€è¦çŸ¥é“åœ¨ grades æ•°ç»„ä¸­åŒ¹é…çš„å…·ä½“ä½ç½®ï¼Œç”¨"),a("code",[s._v("$")]),s._v("æŒ‡ä»£å³å¯ï¼š")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("students"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("insert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"grades"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("85")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("students"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("updateOne")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" _id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" grades"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" $set"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"grades.$"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("82")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h4",{attrs:{id:"upsertæ“ä½œç¬¦"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#upsertæ“ä½œç¬¦"}},[s._v("#")]),s._v(" "),a("code",[s._v("upsert")]),s._v("æ“ä½œç¬¦")]),s._v(" "),a("p",[s._v("ä½œç”¨ï¼šå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ä¼šè‡ªåŠ¨"),a("code",[s._v("insert")]),s._v("ã€‚")]),s._v(" "),a("p",[s._v("å¯¹äºæ·»åŠ åˆ°å•†å“åˆ°è´­ç‰©è½¦ç­‰åœºæ™¯ï¼Œéå¸¸é€‚ç”¨ã€‚")]),s._v(" "),a("h3",{attrs:{id:"_3-äº‹åŠ¡æ€§å·¥ä½œæµ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-äº‹åŠ¡æ€§å·¥ä½œæµ"}},[s._v("#")]),s._v(" 3. äº‹åŠ¡æ€§å·¥ä½œæµ")]),s._v(" "),a("p",[s._v("è¿™é‡Œä¸»è¦ä½¿ç”¨çš„æ˜¯"),a("code",[s._v("findAndModify")]),s._v("å‘½ä»¤ã€‚è¿™ä¸ªå‘½ä»¤ï¼Œæ”¯æŒä¼ å…¥ query å‚æ•°ï¼Œæ¥åšåŒ¹é…ç­›é€‰ï¼›æ”¯æŒ updateï¼Œæ¥åšé’ˆå¯¹æ€§æ›´æ–°ï¼ˆåŸå­æ›´æ–°ï¼‰ã€‚æœ€é‡è¦çš„ç‰¹æ€§æ˜¯ï¼š"),a("strong",[s._v("å¯ä»¥æ ¹æ®"),a("code",[s._v("new")]),s._v("å‚æ•°ï¼Œæ¥è¿”å›æ›´æ–°å‰åçš„æ–‡æ¡£æ•°æ®çŠ¶æ€")]),s._v("ã€‚")]),s._v(" "),a("p",[s._v("å€ŸåŠ©å¯ä»¥è¿”å›æ›´æ–°æ–‡æ¡£æ•°æ®çš„ç‰¹æ€§ï¼Œå¯ä»¥ mock ä¸€ä¸‹ mongo 4.0 ä¹‹å‰ä¸æ”¯æŒçš„äº‹åŠ¡ç‰¹æ€§ã€‚æ€è·¯æ˜¯ï¼š")]),s._v(" "),a("ol",[a("li",[s._v("è·å–æœ€åˆçš„æ–‡æ¡£æ•°æ®")]),s._v(" "),a("li",[s._v("åˆ©ç”¨ findAndModify è¿›è¡Œé’ˆå¯¹æ€§æ›´æ–°ï¼Œæ›´æ–°å­—æ®µä¸­éœ€è¦æºå¸¦æœ¬æ¬¡çš„æ›´æ–°æ ‡ç¤ºï¼ˆæ¯”å¦‚æ—¶é—´æˆ³ï¼‰ã€‚findAndModify æ“ä½œç¬¦å›è¿”å›æ›´æ–°åçš„å­—æ®µã€‚")]),s._v(" "),a("li",[s._v("å°†æ›´æ–°åçš„å­—æ®µä¸­çš„æ›´æ–°æ ‡ç¤ºä¸æœ¬åœ°ä¿å­˜çš„æ ‡ç¤ºåšå¯¹æ¯”ï¼Œå¦‚æœä¸ç›¸åŒï¼Œè¯´æ˜æœ‰åˆ«çš„ç«¯æ›´æ–°äº†æ•°æ®ï¼Œæ•°æ®å‘ç”Ÿäº†æ±¡æŸ“ï¼Œä¸ºäº†ä¿è¯äº‹åŠ¡åŸå­æ€§çš„ç‰¹ç‚¹ï¼Œå°†æ–‡æ¡£æ¢å¤ä¸ºç¬¬ 1 æ­¥è·å¾—åŸå§‹æ•°æ®ï¼›å¦‚æœç›¸åŒï¼Œé‚£ä¹ˆç»§ç»­è¿›è¡Œã€‚")])]),s._v(" "),a("p",[s._v("åœ¨ MongoDB 4.0 ä¸­ï¼Œå°±æ˜¯é€šè¿‡ç±»ä¼¼ç¬¬äºŒæ­¥çš„æ€è·¯ï¼Œæä¾›äº†ä¸€ä¸ª seesionID æ¥å®ç°äº†äº‹åŠ¡çš„ï¼Œä¿è¯äº†äº‹åŠ¡ç‰¹æ€§ã€‚")]),s._v(" "),a("h3",{attrs:{id:"_4-æ›´å¤šçš„æ›´æ–°å‘½ä»¤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-æ›´å¤šçš„æ›´æ–°å‘½ä»¤"}},[s._v("#")]),s._v(" 4. æ›´å¤šçš„æ›´æ–°å‘½ä»¤")]),s._v(" "),a("p",[s._v("updateï¼šmulti å‚æ•°ä¸ç»™ï¼Œé»˜è®¤åªæ›´æ–°åŒ¹é…åˆ°çš„ç¬¬ä¸€ä¸ªæ–‡æ¡£ã€‚")]),s._v(" "),a("p",[s._v("unsetï¼šåˆ é™¤æ–‡æ¡£ä¸­çš„æŒ‡å®šé”®ã€‚")]),s._v(" "),a("p",[s._v("renameï¼šé‡å‘½åé”®ã€‚")]),s._v(" "),a("p",[s._v("addToSetï¼šæ•°ç»„ä¸­ä¸å­˜åœ¨æ—¶å€™ï¼Œæ‰ä¼šåŠ å…¥ã€‚")]),s._v(" "),a("p",[s._v("pullï¼šåˆ é™¤æ•°ç»„æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚")]),s._v(" "),a("h3",{attrs:{id:"_5-æ›´æ–°æœ¬è´¨å’Œä¼˜åŒ–"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-æ›´æ–°æœ¬è´¨å’Œä¼˜åŒ–"}},[s._v("#")]),s._v(" 5. æ›´æ–°æœ¬è´¨å’Œä¼˜åŒ–")]),s._v(" "),a("p",[s._v("æ›´æ–°åˆ†ä¸º 3 ç§ï¼š")]),s._v(" "),a("ul",[a("li",[s._v("åªæ”¹å˜å•å€¼ï¼Œä½† BSON æ–‡æ¡£ä¸å˜ï¼š"),a("code",[s._v("$inc")]),s._v("æ“ä½œç¬¦")]),s._v(" "),a("li",[s._v("æ”¹å˜æ–‡æ¡£å’Œç»“æ„ï¼Œä¼šé‡å†™æ•´ä¸ªæ–‡æ¡£ï¼š"),a("code",[s._v("$push")])]),s._v(" "),a("li",[s._v("æ”¹å˜æ–‡æ¡£é€ æˆç©ºé—´ä¸å¤Ÿï¼Œå…¨éƒ¨æ•´ä½“è¿ç§»åˆ°æ–°ç©ºé—´ï¼šæå‰åˆ©ç”¨"),a("strong",[s._v("å¡«å……å› å­")]),s._v("æ¥å‡å°‘å½±å“")])])])}),[],!1,null,null,null);t.default=e.exports}}]);